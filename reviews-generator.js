/**
 * ูููุฏ ุงูุชููููุงุช ุงููุตุฑูุฉ ุงููุญุณูู
 * Version: 2.0
 * - ุชููููุงุช ุฃูุซุฑ ูุงูุนูุฉ ูุชููุนุงู
 * - ุชูุงุฑูุฎ ISO ุตุญูุญุฉ
 * - ุชูููุน ูู ุงูุชููููุงุช (3-5 ูุฌูู)
 */

// ุชููููุงุช 5 ูุฌูู - ููุชุงุฒุฉ
const excellentReviews = [
    "ููุชุฌ ููุชุงุฒ ุฌุฏุงูุ ูุงูุฌูุฏุฉ ุนุงููุฉ. ุฃูุตุญ ุจูู ุจุดุฏุฉ!",
    "ูุตู ูู ุงูููุนุงุฏ ูุงูุชุบููู ููุชุงุฒ. ุงูููุชุฌ ุฃุญุณู ูู ุงููุชููุน.",
    "ุฌูุฏุฉ ุฑุงุฆุนุฉ ูุงูุณุนุฑ ููุงุณุจ. ุดูุฑุงู ููุจุงุฆุน.",
    "ุงูููุชุฌ ุฒู ูุง ูู ุงูุตูุฑุฉ ุจุงูุธุจุท. ุฑุงุถู ุฌุฏุงู ุนู ุงูุดุฑุงุก.",
    "ููุชุงุฒ ุฌุฏุงูุ ุงุณุชุฎุฏูุชู ูุญุณูุช ุจูุฑู ูุงุถุญ.",
    "ููุชุฌ ุฑููุจ ูุงูุชูุตูู ุณุฑูุน. ูุดุชุฑู ููู ุชุงูู ุฃููุฏ.",
    "ุฌูุฏุฉ ุนุงููุฉ ูุณุนุฑ ูููุณ. ูุณุชุงูู ุงููููุณ.",
    "ุงูููุชุฌ ูุตู ุณููู ูุงูุชุนุจุฆุฉ ูุญุชุฑูุฉ ุฌุฏุงู.",
    "ูุงุดุงุก ุงูููุ ููุชุฌ ุฃุตูู ูุฌูุฏุฉ ููุชุงุฒุฉ.",
    "ุฃูุถู ุญุงุฌุฉ ุงุดุชุฑูุชูุง ุงูุณูุฉ ุฏู. ูุนูุงู ูุณุชุญู.",
    "ููุชุฌ ูููุฒ ูุงูุฎุงูุฉ ูููุฉ. ุจุฌุฏ ุฑุงุถู ุนูู.",
    "ูุตู ุจุณุฑุนุฉ ูุฌูุฏุชู ุญููุฉ. ุดูุฑุงู ุนูู ุงูุฎุฏูุฉ.",
    "ููุชุงุฒ ูุงูุชุนุงูู ุฑุงูู. ูุฑุดุญููุง ูุฃุตุญุงุจู.",
    "ุงูููุชุฌ ุฃูุซุฑ ูู ุฑุงุฆุน. ุงูุตุฑุงุญุฉ ูุชููุนุชุด ูููู ุจุงูุฌูุฏุฉ ุฏู.",
    "ุจุฌุฏ ููุชุฌ ูุณุชุญู ุงูุดุฑุงุก. ุฌุฑุจุชู ูุนุฌุจูู ุฌุฏุงู.",
    "ุฌูุฏุฉ ููุชุงุฒุฉ ูุงูุณุนุฑ ููุงุณุจ ููุฅููุงููุงุช.",
    "ุงูููุชุฌ ููู ุงูุชููุนุงุช. ุดูุฑุงู ุนูู ุงููุฌููุฏ.",
    "ุฑุงุฆุน ุฌุฏุงูุ ูุงููู ูุณุชุงูู ูู ูุฑุด.",
    "ููุชุฌ ุนููู ูุฌูุฏุชู ูููุณุฉ. ุฑุงุถู ุนู ุงูุดุฑุงุก.",
    "ููุชุงุฒุ ูุงูุชูุตูู ูุงู ุฃุณุฑุน ูู ุงููุชููุน.",
    "ุฌูุฏุฉ ูุฎูุฉ ูุงูุฎุงูุฉ ููุชุงุฒุฉ. ุฃูุตุญ ุจุดุฏุฉ."
];

// ุชููููุงุช 4-4.5 ูุฌูู - ุฌูุฏุฉ ุฌุฏุงู
const goodReviews = [
    "ุงูููุชุฌ ุฒู ุงููุตู ุจุงูุธุจุท. ุดูุฑุงู ุฌุฏุงู.",
    "ููุชุฌ ุฑุงุฆุน ูุงูุณุนุฑ ููุงุณุจ. ูุดุชุฑู ูููู ุชุงูู.",
    "ุจุตุฑุงุญุฉ ูุงู ุชููุนุงุชู. ุฑุจูุง ูุจุงุฑู.",
    "ุฌูุฏุฉ ุนุงููุฉ ุฌุฏุงู ูุณุนุฑ ูููุณ. ุฑุงุถู 100%",
    "ุงูุญูุฏ ููู ูุตู ุจุณูุงูุฉ ูุงูููุชุฌ ููุชุงุฒ.",
    "ููุชุฌ ููู ุงูููุชุงุฒ ุจุฌุฏ. ุดูุฑุงู ุฌุฒููุงู.",
    "ุงุณุชููุชู ุงูุจุงุฑุญ ูุฌุฑุจุชู ุงูููุงุฑุฏูุ ูุนูุงู ุฑููุจ!",
    "ุงูููุชุฌ ูุถูู ุฌุฏุงู ูุงูุฎุงูุฉ ูููุฉ. ุจุฌุฏ ุชูุงู.",
    "ุฑุจูุง ูุจุงุฑูุ ููุชุฌ ูููู ุงููุตู ุจูุชูุฑ.",
    "ุฌูุฏุฉ ูููุณุฉ ูุงูุชูุตูู ุณุฑูุน. ููุชุงุฒ."
];

// ุชููููุงุช 3-3.5 ูุฌูู - ุฌูุฏุฉ
const averageReviews = [
    "ุงูููุชุฌ ูููุณ ุจุณ ูุด ุฒู ูุง ุชููุนุช ุจุงูุธุจุท.",
    "ุฌูุฏุฉ ููุจููุฉ ููุณุนุฑ. ูููู ุชุญุณูู ุงูุชุบููู.",
    "ุงูููุชุฌ ุนุงุฏูุ ูุด ูุญุด ุจุณ ููุจูู.",
    "ุงูุชูุตูู ูุงู ูุชุฃุฎุฑ ุดููุฉ ุจุณ ุงูููุชุฌ ูููุณ.",
    "ุฌูุฏุฉ ููุจููุฉ ููุณุนุฑุ ูููุน ููุงุณุชุฎุฏุงู ุงูุนุงุฏู."
];

// ุฃุณูุงุก ูุตุฑูุฉ ููุณุนุฉ
const egyptianNames = [
    // ุฃุณูุงุก ุฑุฌุงู
    "ุฃุญูุฏ ูุญูุฏ", "ูุญูุฏ ุนูู", "ุนูุฑ ุญุณู", "ุฎุงูุฏ ููุณู", "ูุตุทูู ุฃุญูุฏ",
    "ุนุจุฏุงููู ุณุนูุฏ", "ููุฑ ุงูุฏูู", "ูุฑูู ุฑุถุง", "ุญุณุงู ุงูุฏูู", "ุทุงุฑู ูุชุญู",
    "ูููุฏ ุฌูุงู", "ุนูู ุญุณู", "ูุงุฌุฏ ูุงุฑูู", "ูุงุณุฑ ุฅุจุฑุงููู", "ุนุงุตู ูุญููุฏ",
    "ุจุงุณู ุนุจุฏุงูุนุฒูุฒ", "ุดุฑูู ุฎุงูุฏ", "ูุดุงู ุทุงุฑู", "ูุญููุฏ ุณููุฑ", "ุนูุงุฏ ููุฒู",
    "ุชุงูุฑ ุญุณูู", "ุนูุฑู ุฃุดุฑู", "ูุญูุฏ ุญุณุงู", "ุฃููู ุนูู", "ุฑุงูู ุนุงุฏู",
    
    // ุฃุณูุงุก ูุณุงุก
    "ูุงุทูุฉ ูุญููุฏ", "ููู ุฅุจุฑุงููู", "ุณุงุฑุฉ ุญุณูู", "ุฑูู ุนุจุฏุงููู", "ูุงุณููู ุตูุงุญ",
    "ูุฏู ุนุงุฏู", "ููู ุทุงุฑู", "ุฏููุง ูููุฏ", "ุดููุงุก ุนูุฑ", "ุฅููุงู ุณููุฑ",
    "ุฑูุง ูุญูุฏ", "ุณููู ุฃุญูุฏ", "ูุฑูู ุฎุงูุฏ", "ููุฑุงู ุญุณู", "ููู ูุงุฑูู",
    "ุฌูุงุฏ ุนุจุฏุงูุนุฒูุฒ", "ูุฏู ุทุงุฑู", "ูุจุฉ ูุญููุฏ", "ุฅุณุฑุงุก ุฃุญูุฏ", "ุฑูุงู ููุณู",
    "ููุฑูุงู ุนูู", "ูููู ุญุณุงู", "ููุงุฑ ุนุงุตู", "ุฌูู ูุญูุฏ", "ููู ุฑุถุง"
];

/**
 * ุชูููุฏ ุชููููุงุช ุนุดูุงุฆูุฉ ูููุชุฌ
 * @param {string} productId - ูุนุฑู ุงูููุชุฌ
 * @param {number} count - ุนุฏุฏ ุงูุชููููุงุช (20-50 ููุตู ุจูุง)
 * @returns {Array} - ูุงุฆูุฉ ุงูุชููููุงุช
 */
function generateReviews(productId, count = 30) {
    const reviews = [];
    const usedReviews = new Set();
    const usedNames = new Set();
    
    // ุชูุฒูุน ุงูุชููููุงุช: 70% ููุชุงุฒุ 25% ุฌูุฏุฉุ 5% ูุชูุณุทุฉ
    const excellentCount = Math.floor(count * 0.70);
    const goodCount = Math.floor(count * 0.25);
    const averageCount = count - excellentCount - goodCount;
    
    // ุชูููุฏ ุงูุชููููุงุช
    for (let i = 0; i < count; i++) {
        let reviewText, rating;
        
        // ุงุฎุชูุงุฑ ููุน ุงูุชูููู
        if (i < excellentCount) {
            // ุชูููู ููุชุงุฒ (5 ุฃู 4.5)
            reviewText = getRandomUnused(excellentReviews, usedReviews);
            rating = Math.random() > 0.3 ? 5.0 : 4.5;
        } else if (i < excellentCount + goodCount) {
            // ุชูููู ุฌูุฏ (4 ุฃู 4.5)
            reviewText = getRandomUnused(goodReviews, usedReviews);
            rating = Math.random() > 0.5 ? 4.0 : 4.5;
        } else {
            // ุชูููู ูุชูุณุท (3 ุฃู 3.5)
            reviewText = getRandomUnused(averageReviews, usedReviews);
            rating = Math.random() > 0.5 ? 3.0 : 3.5;
        }
        
        // ุงุฎุชูุงุฑ ุงุณู ุนุดูุงุฆู ุบูุฑ ููุฑุฑ
        const name = getRandomUnused(egyptianNames, usedNames);
        
        // ุชุงุฑูุฎ ุนุดูุงุฆู ูู ุขุฎุฑ 180 ููู
        const daysAgo = Math.floor(Math.random() * 180) + 1;
        const reviewDate = new Date();
        reviewDate.setDate(reviewDate.getDate() - daysAgo);
        
        // 90% ูุดุชุฑูุงุช ููุซูุฉ
        const isVerified = Math.random() > 0.1;
        
        reviews.push({
            id: `${productId}-review-${i}`,
            reviewer_name: name,
            rating: rating,
            comment: reviewText,
            date: reviewDate.toISOString(),
            verified_purchase: isVerified,
            helpful_count: Math.floor(Math.random() * 20)
        });
    }
    
    // ุชุฑุชูุจ ุญุณุจ ุงูุชุงุฑูุฎ (ุงูุฃุญุฏุซ ุฃููุงู)
    reviews.sort((a, b) => new Date(b.date) - new Date(a.date));
    
    return reviews;
}

/**
 * ูุณุงุนุฏ: ุงุฎุชูุงุฑ ุนูุตุฑ ุนุดูุงุฆู ุบูุฑ ูุณุชุฎุฏู
 */
function getRandomUnused(array, usedSet) {
    let attempts = 0;
    const maxAttempts = 100;
    
    while (attempts < maxAttempts) {
        const index = Math.floor(Math.random() * array.length);
        const item = array[index];
        
        if (!usedSet.has(item)) {
            usedSet.add(item);
            return item;
        }
        attempts++;
    }
    
    // ุฅุฐุง ุชู ุงุณุชุฎุฏุงู ูู ุงูุนูุงุตุฑุ ุฅุฑุฌุงุน ุนุดูุงุฆู
    return array[Math.floor(Math.random() * array.length)];
}

/**
 * ุญุณุงุจ ูุชูุณุท ุงูุชูููู
 */
function calculateAverageRating(reviews) {
    if (!reviews || reviews.length === 0) return 0;
    const sum = reviews.reduce((acc, review) => acc + (review.rating || 0), 0);
    return (sum / reviews.length).toFixed(1);
}

/**
 * ุนุฑุถ ุงูุชููููุงุช ุจุชุตููู ุงุญุชุฑุงูู (ูุชูุงูู ูุน reviews-display.js)
 */
function displayReviews(reviews) {
    if (!reviews || reviews.length === 0) {
        return '<p style="text-align: center; color: #999; padding: 20px;">ูุง ุชูุฌุฏ ุชููููุงุช ุจุนุฏ</p>';
    }
    
    const avgRating = calculateAverageRating(reviews);
    
    // ุงุณุชุฎุฏุงู displayProductReviews ูู reviews-display.js ุฅุฐุง ูุงู ูุชููุฑุงู
    if (typeof displayProductReviews === 'function') {
        return displayProductReviews(reviews, parseFloat(avgRating), reviews.length);
    }
    
    // ุนุฑุถ ุจุณูุท ุฅุฐุง ูู ุชูู displayProductReviews ูุชููุฑุฉ
    return `<div class="reviews-simple">
        <h3>ุงูุชูููู: ${avgRating} โ (${reviews.length} ุชูููู)</h3>
    </div>`;
}

// ุชุตุฏูุฑ ููุงุณุชุฎุฏุงู
if (typeof module !== 'undefined' && module.exports) {
    module.exports = { 
        generateReviews, 
        displayReviews,
        calculateAverageRating,
        excellentReviews,
        goodReviews,
        averageReviews,
        egyptianNames
    };
}

console.log('โ reviews-generator.js v2.0 - ุชู ุงูุชุญููู ุจูุฌุงุญ');
console.log(`๐ ุฅุญุตุงุฆูุงุช: ${excellentReviews.length + goodReviews.length + averageReviews.length} ุชูููู | ${egyptianNames.length} ุงุณู`);